{"ast":null,"code":"/**\n * @internal\n **/\nexport class AlphaState {\n  /**\n   * Initializes the state.\n   */\n  constructor() {\n    this._blendFunctionParameters = new Array(4);\n    this._blendEquationParameters = new Array(2);\n    this._blendConstants = new Array(4);\n    this._isBlendConstantsDirty = false;\n    this._alphaBlend = false;\n    this._isAlphaBlendDirty = false;\n    this._isBlendFunctionParametersDirty = false;\n    this._isBlendEquationParametersDirty = false;\n    this.reset();\n  }\n  get isDirty() {\n    return this._isAlphaBlendDirty || this._isBlendFunctionParametersDirty || this._isBlendEquationParametersDirty;\n  }\n  get alphaBlend() {\n    return this._alphaBlend;\n  }\n  set alphaBlend(value) {\n    if (this._alphaBlend === value) {\n      return;\n    }\n    this._alphaBlend = value;\n    this._isAlphaBlendDirty = true;\n  }\n  setAlphaBlendConstants(r, g, b, a) {\n    if (this._blendConstants[0] === r && this._blendConstants[1] === g && this._blendConstants[2] === b && this._blendConstants[3] === a) {\n      return;\n    }\n    this._blendConstants[0] = r;\n    this._blendConstants[1] = g;\n    this._blendConstants[2] = b;\n    this._blendConstants[3] = a;\n    this._isBlendConstantsDirty = true;\n  }\n  setAlphaBlendFunctionParameters(value0, value1, value2, value3) {\n    if (this._blendFunctionParameters[0] === value0 && this._blendFunctionParameters[1] === value1 && this._blendFunctionParameters[2] === value2 && this._blendFunctionParameters[3] === value3) {\n      return;\n    }\n    this._blendFunctionParameters[0] = value0;\n    this._blendFunctionParameters[1] = value1;\n    this._blendFunctionParameters[2] = value2;\n    this._blendFunctionParameters[3] = value3;\n    this._isBlendFunctionParametersDirty = true;\n  }\n  setAlphaEquationParameters(rgb, alpha) {\n    if (this._blendEquationParameters[0] === rgb && this._blendEquationParameters[1] === alpha) {\n      return;\n    }\n    this._blendEquationParameters[0] = rgb;\n    this._blendEquationParameters[1] = alpha;\n    this._isBlendEquationParametersDirty = true;\n  }\n  reset() {\n    this._alphaBlend = false;\n    this._blendFunctionParameters[0] = null;\n    this._blendFunctionParameters[1] = null;\n    this._blendFunctionParameters[2] = null;\n    this._blendFunctionParameters[3] = null;\n    this._blendEquationParameters[0] = null;\n    this._blendEquationParameters[1] = null;\n    this._blendConstants[0] = null;\n    this._blendConstants[1] = null;\n    this._blendConstants[2] = null;\n    this._blendConstants[3] = null;\n    this._isAlphaBlendDirty = true;\n    this._isBlendFunctionParametersDirty = false;\n    this._isBlendEquationParametersDirty = false;\n    this._isBlendConstantsDirty = false;\n  }\n  apply(gl) {\n    if (!this.isDirty) {\n      return;\n    }\n    // Alpha blend\n    if (this._isAlphaBlendDirty) {\n      if (this._alphaBlend) {\n        gl.enable(gl.BLEND);\n      } else {\n        gl.disable(gl.BLEND);\n      }\n      this._isAlphaBlendDirty = false;\n    }\n    // Alpha function\n    if (this._isBlendFunctionParametersDirty) {\n      gl.blendFuncSeparate(this._blendFunctionParameters[0], this._blendFunctionParameters[1], this._blendFunctionParameters[2], this._blendFunctionParameters[3]);\n      this._isBlendFunctionParametersDirty = false;\n    }\n    // Alpha equation\n    if (this._isBlendEquationParametersDirty) {\n      gl.blendEquationSeparate(this._blendEquationParameters[0], this._blendEquationParameters[1]);\n      this._isBlendEquationParametersDirty = false;\n    }\n    // Constants\n    if (this._isBlendConstantsDirty) {\n      gl.blendColor(this._blendConstants[0], this._blendConstants[1], this._blendConstants[2], this._blendConstants[3]);\n      this._isBlendConstantsDirty = false;\n    }\n  }\n}","map":{"version":3,"names":["AlphaState","constructor","_blendFunctionParameters","Array","_blendEquationParameters","_blendConstants","_isBlendConstantsDirty","_alphaBlend","_isAlphaBlendDirty","_isBlendFunctionParametersDirty","_isBlendEquationParametersDirty","reset","isDirty","alphaBlend","value","setAlphaBlendConstants","r","g","b","a","setAlphaBlendFunctionParameters","value0","value1","value2","value3","setAlphaEquationParameters","rgb","alpha","apply","gl","enable","BLEND","disable","blendFuncSeparate","blendEquationSeparate","blendColor"],"sources":["../../../../dev/core/src/States/alphaCullingState.ts"],"sourcesContent":["import type { Nullable } from \"../types\";\r\n\r\n/**\r\n * @internal\r\n **/\r\nexport class AlphaState {\r\n    public _blendFunctionParameters = new Array<Nullable<number>>(4);\r\n    public _blendEquationParameters = new Array<Nullable<number>>(2);\r\n    public _blendConstants = new Array<Nullable<number>>(4);\r\n    public _isBlendConstantsDirty = false;\r\n\r\n    private _alphaBlend = false;\r\n    private _isAlphaBlendDirty = false;\r\n    private _isBlendFunctionParametersDirty = false;\r\n    private _isBlendEquationParametersDirty = false;\r\n\r\n    /**\r\n     * Initializes the state.\r\n     */\r\n    public constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    public get isDirty(): boolean {\r\n        return this._isAlphaBlendDirty || this._isBlendFunctionParametersDirty || this._isBlendEquationParametersDirty;\r\n    }\r\n\r\n    public get alphaBlend(): boolean {\r\n        return this._alphaBlend;\r\n    }\r\n\r\n    public set alphaBlend(value: boolean) {\r\n        if (this._alphaBlend === value) {\r\n            return;\r\n        }\r\n\r\n        this._alphaBlend = value;\r\n        this._isAlphaBlendDirty = true;\r\n    }\r\n\r\n    public setAlphaBlendConstants(r: number, g: number, b: number, a: number): void {\r\n        if (this._blendConstants[0] === r && this._blendConstants[1] === g && this._blendConstants[2] === b && this._blendConstants[3] === a) {\r\n            return;\r\n        }\r\n\r\n        this._blendConstants[0] = r;\r\n        this._blendConstants[1] = g;\r\n        this._blendConstants[2] = b;\r\n        this._blendConstants[3] = a;\r\n\r\n        this._isBlendConstantsDirty = true;\r\n    }\r\n\r\n    public setAlphaBlendFunctionParameters(value0: number, value1: number, value2: number, value3: number): void {\r\n        if (\r\n            this._blendFunctionParameters[0] === value0 &&\r\n            this._blendFunctionParameters[1] === value1 &&\r\n            this._blendFunctionParameters[2] === value2 &&\r\n            this._blendFunctionParameters[3] === value3\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        this._blendFunctionParameters[0] = value0;\r\n        this._blendFunctionParameters[1] = value1;\r\n        this._blendFunctionParameters[2] = value2;\r\n        this._blendFunctionParameters[3] = value3;\r\n\r\n        this._isBlendFunctionParametersDirty = true;\r\n    }\r\n\r\n    public setAlphaEquationParameters(rgb: number, alpha: number): void {\r\n        if (this._blendEquationParameters[0] === rgb && this._blendEquationParameters[1] === alpha) {\r\n            return;\r\n        }\r\n\r\n        this._blendEquationParameters[0] = rgb;\r\n        this._blendEquationParameters[1] = alpha;\r\n\r\n        this._isBlendEquationParametersDirty = true;\r\n    }\r\n\r\n    public reset() {\r\n        this._alphaBlend = false;\r\n        this._blendFunctionParameters[0] = null;\r\n        this._blendFunctionParameters[1] = null;\r\n        this._blendFunctionParameters[2] = null;\r\n        this._blendFunctionParameters[3] = null;\r\n\r\n        this._blendEquationParameters[0] = null;\r\n        this._blendEquationParameters[1] = null;\r\n\r\n        this._blendConstants[0] = null;\r\n        this._blendConstants[1] = null;\r\n        this._blendConstants[2] = null;\r\n        this._blendConstants[3] = null;\r\n\r\n        this._isAlphaBlendDirty = true;\r\n        this._isBlendFunctionParametersDirty = false;\r\n        this._isBlendEquationParametersDirty = false;\r\n        this._isBlendConstantsDirty = false;\r\n    }\r\n\r\n    public apply(gl: WebGLRenderingContext) {\r\n        if (!this.isDirty) {\r\n            return;\r\n        }\r\n\r\n        // Alpha blend\r\n        if (this._isAlphaBlendDirty) {\r\n            if (this._alphaBlend) {\r\n                gl.enable(gl.BLEND);\r\n            } else {\r\n                gl.disable(gl.BLEND);\r\n            }\r\n\r\n            this._isAlphaBlendDirty = false;\r\n        }\r\n\r\n        // Alpha function\r\n        if (this._isBlendFunctionParametersDirty) {\r\n            gl.blendFuncSeparate(\r\n                <number>this._blendFunctionParameters[0],\r\n                <number>this._blendFunctionParameters[1],\r\n                <number>this._blendFunctionParameters[2],\r\n                <number>this._blendFunctionParameters[3]\r\n            );\r\n            this._isBlendFunctionParametersDirty = false;\r\n        }\r\n\r\n        // Alpha equation\r\n        if (this._isBlendEquationParametersDirty) {\r\n            gl.blendEquationSeparate(this._blendEquationParameters[0]!, this._blendEquationParameters[1]!);\r\n            this._isBlendEquationParametersDirty = false;\r\n        }\r\n\r\n        // Constants\r\n        if (this._isBlendConstantsDirty) {\r\n            gl.blendColor(<number>this._blendConstants[0], <number>this._blendConstants[1], <number>this._blendConstants[2], <number>this._blendConstants[3]);\r\n            this._isBlendConstantsDirty = false;\r\n        }\r\n    }\r\n}\r\n"],"mappings":"AAEA;;;AAGA,OAAM,MAAOA,UAAU;EAWnB;;;EAGAC,YAAA;IAbO,KAAAC,wBAAwB,GAAG,IAAIC,KAAK,CAAmB,CAAC,CAAC;IACzD,KAAAC,wBAAwB,GAAG,IAAID,KAAK,CAAmB,CAAC,CAAC;IACzD,KAAAE,eAAe,GAAG,IAAIF,KAAK,CAAmB,CAAC,CAAC;IAChD,KAAAG,sBAAsB,GAAG,KAAK;IAE7B,KAAAC,WAAW,GAAG,KAAK;IACnB,KAAAC,kBAAkB,GAAG,KAAK;IAC1B,KAAAC,+BAA+B,GAAG,KAAK;IACvC,KAAAC,+BAA+B,GAAG,KAAK;IAM3C,IAAI,CAACC,KAAK,EAAE;EAChB;EAEA,IAAWC,OAAOA,CAAA;IACd,OAAO,IAAI,CAACJ,kBAAkB,IAAI,IAAI,CAACC,+BAA+B,IAAI,IAAI,CAACC,+BAA+B;EAClH;EAEA,IAAWG,UAAUA,CAAA;IACjB,OAAO,IAAI,CAACN,WAAW;EAC3B;EAEA,IAAWM,UAAUA,CAACC,KAAc;IAChC,IAAI,IAAI,CAACP,WAAW,KAAKO,KAAK,EAAE;MAC5B;;IAGJ,IAAI,CAACP,WAAW,GAAGO,KAAK;IACxB,IAAI,CAACN,kBAAkB,GAAG,IAAI;EAClC;EAEOO,sBAAsBA,CAACC,CAAS,EAAEC,CAAS,EAAEC,CAAS,EAAEC,CAAS;IACpE,IAAI,IAAI,CAACd,eAAe,CAAC,CAAC,CAAC,KAAKW,CAAC,IAAI,IAAI,CAACX,eAAe,CAAC,CAAC,CAAC,KAAKY,CAAC,IAAI,IAAI,CAACZ,eAAe,CAAC,CAAC,CAAC,KAAKa,CAAC,IAAI,IAAI,CAACb,eAAe,CAAC,CAAC,CAAC,KAAKc,CAAC,EAAE;MAClI;;IAGJ,IAAI,CAACd,eAAe,CAAC,CAAC,CAAC,GAAGW,CAAC;IAC3B,IAAI,CAACX,eAAe,CAAC,CAAC,CAAC,GAAGY,CAAC;IAC3B,IAAI,CAACZ,eAAe,CAAC,CAAC,CAAC,GAAGa,CAAC;IAC3B,IAAI,CAACb,eAAe,CAAC,CAAC,CAAC,GAAGc,CAAC;IAE3B,IAAI,CAACb,sBAAsB,GAAG,IAAI;EACtC;EAEOc,+BAA+BA,CAACC,MAAc,EAAEC,MAAc,EAAEC,MAAc,EAAEC,MAAc;IACjG,IACI,IAAI,CAACtB,wBAAwB,CAAC,CAAC,CAAC,KAAKmB,MAAM,IAC3C,IAAI,CAACnB,wBAAwB,CAAC,CAAC,CAAC,KAAKoB,MAAM,IAC3C,IAAI,CAACpB,wBAAwB,CAAC,CAAC,CAAC,KAAKqB,MAAM,IAC3C,IAAI,CAACrB,wBAAwB,CAAC,CAAC,CAAC,KAAKsB,MAAM,EAC7C;MACE;;IAGJ,IAAI,CAACtB,wBAAwB,CAAC,CAAC,CAAC,GAAGmB,MAAM;IACzC,IAAI,CAACnB,wBAAwB,CAAC,CAAC,CAAC,GAAGoB,MAAM;IACzC,IAAI,CAACpB,wBAAwB,CAAC,CAAC,CAAC,GAAGqB,MAAM;IACzC,IAAI,CAACrB,wBAAwB,CAAC,CAAC,CAAC,GAAGsB,MAAM;IAEzC,IAAI,CAACf,+BAA+B,GAAG,IAAI;EAC/C;EAEOgB,0BAA0BA,CAACC,GAAW,EAAEC,KAAa;IACxD,IAAI,IAAI,CAACvB,wBAAwB,CAAC,CAAC,CAAC,KAAKsB,GAAG,IAAI,IAAI,CAACtB,wBAAwB,CAAC,CAAC,CAAC,KAAKuB,KAAK,EAAE;MACxF;;IAGJ,IAAI,CAACvB,wBAAwB,CAAC,CAAC,CAAC,GAAGsB,GAAG;IACtC,IAAI,CAACtB,wBAAwB,CAAC,CAAC,CAAC,GAAGuB,KAAK;IAExC,IAAI,CAACjB,+BAA+B,GAAG,IAAI;EAC/C;EAEOC,KAAKA,CAAA;IACR,IAAI,CAACJ,WAAW,GAAG,KAAK;IACxB,IAAI,CAACL,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IACvC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IACvC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IACvC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IAEvC,IAAI,CAACE,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IACvC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,GAAG,IAAI;IAEvC,IAAI,CAACC,eAAe,CAAC,CAAC,CAAC,GAAG,IAAI;IAC9B,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,GAAG,IAAI;IAC9B,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,GAAG,IAAI;IAC9B,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,GAAG,IAAI;IAE9B,IAAI,CAACG,kBAAkB,GAAG,IAAI;IAC9B,IAAI,CAACC,+BAA+B,GAAG,KAAK;IAC5C,IAAI,CAACC,+BAA+B,GAAG,KAAK;IAC5C,IAAI,CAACJ,sBAAsB,GAAG,KAAK;EACvC;EAEOsB,KAAKA,CAACC,EAAyB;IAClC,IAAI,CAAC,IAAI,CAACjB,OAAO,EAAE;MACf;;IAGJ;IACA,IAAI,IAAI,CAACJ,kBAAkB,EAAE;MACzB,IAAI,IAAI,CAACD,WAAW,EAAE;QAClBsB,EAAE,CAACC,MAAM,CAACD,EAAE,CAACE,KAAK,CAAC;OACtB,MAAM;QACHF,EAAE,CAACG,OAAO,CAACH,EAAE,CAACE,KAAK,CAAC;;MAGxB,IAAI,CAACvB,kBAAkB,GAAG,KAAK;;IAGnC;IACA,IAAI,IAAI,CAACC,+BAA+B,EAAE;MACtCoB,EAAE,CAACI,iBAAiB,CACR,IAAI,CAAC/B,wBAAwB,CAAC,CAAC,CAAC,EAChC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,EAChC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,EAChC,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAC,CAC3C;MACD,IAAI,CAACO,+BAA+B,GAAG,KAAK;;IAGhD;IACA,IAAI,IAAI,CAACC,+BAA+B,EAAE;MACtCmB,EAAE,CAACK,qBAAqB,CAAC,IAAI,CAAC9B,wBAAwB,CAAC,CAAC,CAAE,EAAE,IAAI,CAACA,wBAAwB,CAAC,CAAC,CAAE,CAAC;MAC9F,IAAI,CAACM,+BAA+B,GAAG,KAAK;;IAGhD;IACA,IAAI,IAAI,CAACJ,sBAAsB,EAAE;MAC7BuB,EAAE,CAACM,UAAU,CAAS,IAAI,CAAC9B,eAAe,CAAC,CAAC,CAAC,EAAU,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,EAAU,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,EAAU,IAAI,CAACA,eAAe,CAAC,CAAC,CAAC,CAAC;MACjJ,IAAI,CAACC,sBAAsB,GAAG,KAAK;;EAE3C"},"metadata":{},"sourceType":"module","externalDependencies":[]}