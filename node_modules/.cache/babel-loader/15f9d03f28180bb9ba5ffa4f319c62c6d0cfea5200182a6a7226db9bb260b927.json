{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { NodeMaterialBlockConnectionPointTypes } from \"./Enums/nodeMaterialBlockConnectionPointTypes.js\";\nimport { NodeMaterialBlockTargets } from \"./Enums/nodeMaterialBlockTargets.js\";\nimport { Effect } from \"../effect.js\";\n/**\n * Class used to store node based material build state\n */\nexport class NodeMaterialBuildState {\n  constructor() {\n    /** Gets or sets a boolean indicating if the current state can emit uniform buffers */\n    this.supportUniformBuffers = false;\n    /**\n     * Gets the list of emitted attributes\n     */\n    this.attributes = new Array();\n    /**\n     * Gets the list of emitted uniforms\n     */\n    this.uniforms = new Array();\n    /**\n     * Gets the list of emitted constants\n     */\n    this.constants = new Array();\n    /**\n     * Gets the list of emitted samplers\n     */\n    this.samplers = new Array();\n    /**\n     * Gets the list of emitted functions\n     */\n    this.functions = {};\n    /**\n     * Gets the list of emitted extensions\n     */\n    this.extensions = {};\n    /**\n     * Gets the list of emitted prePass outputs - if using the prepass\n     */\n    this.prePassOutput = {};\n    /**\n     * Gets the list of emitted counters\n     */\n    this.counters = {};\n    /** @internal */\n    this._attributeDeclaration = \"\";\n    /** @internal */\n    this._uniformDeclaration = \"\";\n    /** @internal */\n    this._constantDeclaration = \"\";\n    /** @internal */\n    this._samplerDeclaration = \"\";\n    /** @internal */\n    this._varyingTransfer = \"\";\n    /** @internal */\n    this._injectAtEnd = \"\";\n    this._repeatableContentAnchorIndex = 0;\n    /** @internal */\n    this._builtCompilationString = \"\";\n    /**\n     * Gets the emitted compilation strings\n     */\n    this.compilationString = \"\";\n  }\n  /**\n   * Finalize the compilation strings\n   * @param state defines the current compilation state\n   */\n  finalize(state) {\n    const emitComments = state.sharedData.emitComments;\n    const isFragmentMode = this.target === NodeMaterialBlockTargets.Fragment;\n    this.compilationString = `\\n${emitComments ? \"//Entry point\\n\" : \"\"}void main(void) {\\n${this.compilationString}`;\n    if (this._constantDeclaration) {\n      this.compilationString = `\\n${emitComments ? \"//Constants\\n\" : \"\"}${this._constantDeclaration}\\n${this.compilationString}`;\n    }\n    let functionCode = \"\";\n    for (const functionName in this.functions) {\n      functionCode += this.functions[functionName] + `\\n`;\n    }\n    this.compilationString = `\\n${functionCode}\\n${this.compilationString}`;\n    if (!isFragmentMode && this._varyingTransfer) {\n      this.compilationString = `${this.compilationString}\\n${this._varyingTransfer}`;\n    }\n    if (this._injectAtEnd) {\n      this.compilationString = `${this.compilationString}\\n${this._injectAtEnd}`;\n    }\n    this.compilationString = `${this.compilationString}\\n}`;\n    if (this.sharedData.varyingDeclaration) {\n      this.compilationString = `\\n${emitComments ? \"//Varyings\\n\" : \"\"}${this.sharedData.varyingDeclaration}\\n${this.compilationString}`;\n    }\n    if (this._samplerDeclaration) {\n      this.compilationString = `\\n${emitComments ? \"//Samplers\\n\" : \"\"}${this._samplerDeclaration}\\n${this.compilationString}`;\n    }\n    if (this._uniformDeclaration) {\n      this.compilationString = `\\n${emitComments ? \"//Uniforms\\n\" : \"\"}${this._uniformDeclaration}\\n${this.compilationString}`;\n    }\n    if (this._attributeDeclaration && !isFragmentMode) {\n      this.compilationString = `\\n${emitComments ? \"//Attributes\\n\" : \"\"}${this._attributeDeclaration}\\n${this.compilationString}`;\n    }\n    this.compilationString = \"precision highp float;\\n\" + this.compilationString;\n    this.compilationString = \"#if defined(WEBGL2) || defines(WEBGPU)\\nprecision highp sampler2DArray;\\n#endif\\n\" + this.compilationString;\n    if (isFragmentMode) {\n      this.compilationString = \"#if defined(PREPASS)\\r\\n#extension GL_EXT_draw_buffers : require\\r\\nlayout(location = 0) out highp vec4 glFragData[SCENE_MRT_COUNT];\\r\\nhighp vec4 gl_FragColor;\\r\\n#endif\\r\\n\" + this.compilationString;\n    }\n    for (const extensionName in this.extensions) {\n      const extension = this.extensions[extensionName];\n      this.compilationString = `\\n${extension}\\n${this.compilationString}`;\n    }\n    this._builtCompilationString = this.compilationString;\n  }\n  /** @internal */\n  get _repeatableContentAnchor() {\n    return `###___ANCHOR${this._repeatableContentAnchorIndex++}___###`;\n  }\n  /**\n   * @internal\n   */\n  _getFreeVariableName(prefix) {\n    prefix = prefix.replace(/[^a-zA-Z_]+/g, \"\");\n    if (this.sharedData.variableNames[prefix] === undefined) {\n      this.sharedData.variableNames[prefix] = 0;\n      // Check reserved words\n      if (prefix === \"output\" || prefix === \"texture\") {\n        return prefix + this.sharedData.variableNames[prefix];\n      }\n      return prefix;\n    } else {\n      this.sharedData.variableNames[prefix]++;\n    }\n    return prefix + this.sharedData.variableNames[prefix];\n  }\n  /**\n   * @internal\n   */\n  _getFreeDefineName(prefix) {\n    if (this.sharedData.defineNames[prefix] === undefined) {\n      this.sharedData.defineNames[prefix] = 0;\n    } else {\n      this.sharedData.defineNames[prefix]++;\n    }\n    return prefix + this.sharedData.defineNames[prefix];\n  }\n  /**\n   * @internal\n   */\n  _excludeVariableName(name) {\n    this.sharedData.variableNames[name] = 0;\n  }\n  /**\n   * @internal\n   */\n  _emit2DSampler(name) {\n    if (this.samplers.indexOf(name) < 0) {\n      this._samplerDeclaration += `uniform sampler2D ${name};\\n`;\n      this.samplers.push(name);\n    }\n  }\n  /**\n   * @internal\n   */\n  _emit2DArraySampler(name) {\n    if (this.samplers.indexOf(name) < 0) {\n      this._samplerDeclaration += `uniform sampler2DArray ${name};\\n`;\n      this.samplers.push(name);\n    }\n  }\n  /**\n   * @internal\n   */\n  _getGLType(type) {\n    switch (type) {\n      case NodeMaterialBlockConnectionPointTypes.Float:\n        return \"float\";\n      case NodeMaterialBlockConnectionPointTypes.Int:\n        return \"int\";\n      case NodeMaterialBlockConnectionPointTypes.Vector2:\n        return \"vec2\";\n      case NodeMaterialBlockConnectionPointTypes.Color3:\n      case NodeMaterialBlockConnectionPointTypes.Vector3:\n        return \"vec3\";\n      case NodeMaterialBlockConnectionPointTypes.Color4:\n      case NodeMaterialBlockConnectionPointTypes.Vector4:\n        return \"vec4\";\n      case NodeMaterialBlockConnectionPointTypes.Matrix:\n        return \"mat4\";\n    }\n    return \"\";\n  }\n  /**\n   * @internal\n   */\n  _emitExtension(name, extension, define = \"\") {\n    if (this.extensions[name]) {\n      return;\n    }\n    if (define) {\n      extension = `#if ${define}\\n${extension}\\n#endif`;\n    }\n    this.extensions[name] = extension;\n  }\n  /**\n   * @internal\n   */\n  _emitFunction(name, code, comments) {\n    if (this.functions[name]) {\n      return;\n    }\n    if (this.sharedData.emitComments) {\n      code = comments + `\\n` + code;\n    }\n    this.functions[name] = code;\n  }\n  /**\n   * @internal\n   */\n  _emitCodeFromInclude(includeName, comments, options) {\n    if (options && options.repeatKey) {\n      return `#include<${includeName}>${options.substitutionVars ? \"(\" + options.substitutionVars + \")\" : \"\"}[0..${options.repeatKey}]\\n`;\n    }\n    let code = Effect.IncludesShadersStore[includeName] + \"\\n\";\n    if (this.sharedData.emitComments) {\n      code = comments + `\\n` + code;\n    }\n    if (!options) {\n      return code;\n    }\n    if (options.replaceStrings) {\n      for (let index = 0; index < options.replaceStrings.length; index++) {\n        const replaceString = options.replaceStrings[index];\n        code = code.replace(replaceString.search, replaceString.replace);\n      }\n    }\n    return code;\n  }\n  /**\n   * @internal\n   */\n  _emitFunctionFromInclude(includeName, comments, options, storeKey = \"\") {\n    const key = includeName + storeKey;\n    if (this.functions[key]) {\n      return;\n    }\n    if (!options || !options.removeAttributes && !options.removeUniforms && !options.removeVaryings && !options.removeIfDef && !options.replaceStrings) {\n      if (options && options.repeatKey) {\n        this.functions[key] = `#include<${includeName}>${options.substitutionVars ? \"(\" + options.substitutionVars + \")\" : \"\"}[0..${options.repeatKey}]\\n`;\n      } else {\n        this.functions[key] = `#include<${includeName}>${(options === null || options === void 0 ? void 0 : options.substitutionVars) ? \"(\" + (options === null || options === void 0 ? void 0 : options.substitutionVars) + \")\" : \"\"}\\n`;\n      }\n      if (this.sharedData.emitComments) {\n        this.functions[key] = comments + `\\n` + this.functions[key];\n      }\n      return;\n    }\n    this.functions[key] = Effect.IncludesShadersStore[includeName];\n    if (this.sharedData.emitComments) {\n      this.functions[key] = comments + `\\n` + this.functions[key];\n    }\n    if (options.removeIfDef) {\n      this.functions[key] = this.functions[key].replace(/^\\s*?#ifdef.+$/gm, \"\");\n      this.functions[key] = this.functions[key].replace(/^\\s*?#endif.*$/gm, \"\");\n      this.functions[key] = this.functions[key].replace(/^\\s*?#else.*$/gm, \"\");\n      this.functions[key] = this.functions[key].replace(/^\\s*?#elif.*$/gm, \"\");\n    }\n    if (options.removeAttributes) {\n      this.functions[key] = this.functions[key].replace(/\\s*?attribute .+?;/g, \"\\n\");\n    }\n    if (options.removeUniforms) {\n      this.functions[key] = this.functions[key].replace(/\\s*?uniform .*?;/g, \"\\n\");\n    }\n    if (options.removeVaryings) {\n      this.functions[key] = this.functions[key].replace(/\\s*?(varying|in) .+?;/g, \"\\n\");\n    }\n    if (options.replaceStrings) {\n      for (let index = 0; index < options.replaceStrings.length; index++) {\n        const replaceString = options.replaceStrings[index];\n        this.functions[key] = this.functions[key].replace(replaceString.search, replaceString.replace);\n      }\n    }\n  }\n  /**\n   * @internal\n   */\n  _registerTempVariable(name) {\n    if (this.sharedData.temps.indexOf(name) !== -1) {\n      return false;\n    }\n    this.sharedData.temps.push(name);\n    return true;\n  }\n  /**\n   * @internal\n   */\n  _emitVaryingFromString(name, type, define = \"\", notDefine = false) {\n    if (this.sharedData.varyings.indexOf(name) !== -1) {\n      return false;\n    }\n    this.sharedData.varyings.push(name);\n    if (define) {\n      if (define.startsWith(\"defined(\")) {\n        this.sharedData.varyingDeclaration += `#if ${define}\\n`;\n      } else {\n        this.sharedData.varyingDeclaration += `${notDefine ? \"#ifndef\" : \"#ifdef\"} ${define}\\n`;\n      }\n    }\n    this.sharedData.varyingDeclaration += `varying ${type} ${name};\\n`;\n    if (define) {\n      this.sharedData.varyingDeclaration += `#endif\\n`;\n    }\n    return true;\n  }\n  /**\n   * @internal\n   */\n  _emitUniformFromString(name, type, define = \"\", notDefine = false) {\n    if (this.uniforms.indexOf(name) !== -1) {\n      return;\n    }\n    this.uniforms.push(name);\n    if (define) {\n      if (define.startsWith(\"defined(\")) {\n        this._uniformDeclaration += `#if ${define}\\n`;\n      } else {\n        this._uniformDeclaration += `${notDefine ? \"#ifndef\" : \"#ifdef\"} ${define}\\n`;\n      }\n    }\n    this._uniformDeclaration += `uniform ${type} ${name};\\n`;\n    if (define) {\n      this._uniformDeclaration += `#endif\\n`;\n    }\n  }\n  /**\n   * @internal\n   */\n  _emitFloat(value) {\n    if (value.toString() === value.toFixed(0)) {\n      return `${value}.0`;\n    }\n    return value.toString();\n  }\n}","map":{"version":3,"names":["NodeMaterialBlockConnectionPointTypes","NodeMaterialBlockTargets","Effect","NodeMaterialBuildState","constructor","supportUniformBuffers","attributes","Array","uniforms","constants","samplers","functions","extensions","prePassOutput","counters","_attributeDeclaration","_uniformDeclaration","_constantDeclaration","_samplerDeclaration","_varyingTransfer","_injectAtEnd","_repeatableContentAnchorIndex","_builtCompilationString","compilationString","finalize","state","emitComments","sharedData","isFragmentMode","target","Fragment","functionCode","functionName","varyingDeclaration","extensionName","extension","_repeatableContentAnchor","_getFreeVariableName","prefix","replace","variableNames","undefined","_getFreeDefineName","defineNames","_excludeVariableName","name","_emit2DSampler","indexOf","push","_emit2DArraySampler","_getGLType","type","Float","Int","Vector2","Color3","Vector3","Color4","Vector4","Matrix","_emitExtension","define","_emitFunction","code","comments","_emitCodeFromInclude","includeName","options","repeatKey","substitutionVars","IncludesShadersStore","replaceStrings","index","length","replaceString","search","_emitFunctionFromInclude","storeKey","key","removeAttributes","removeUniforms","removeVaryings","removeIfDef","_registerTempVariable","temps","_emitVaryingFromString","notDefine","varyings","startsWith","_emitUniformFromString","_emitFloat","value","toString","toFixed"],"sources":["../../../../../dev/core/src/Materials/Node/nodeMaterialBuildState.ts"],"sourcesContent":["import { NodeMaterialBlockConnectionPointTypes } from \"./Enums/nodeMaterialBlockConnectionPointTypes\";\r\nimport { NodeMaterialBlockTargets } from \"./Enums/nodeMaterialBlockTargets\";\r\nimport type { NodeMaterialBuildStateSharedData } from \"./nodeMaterialBuildStateSharedData\";\r\nimport { Effect } from \"../effect\";\r\n\r\n/**\r\n * Class used to store node based material build state\r\n */\r\nexport class NodeMaterialBuildState {\r\n    /** Gets or sets a boolean indicating if the current state can emit uniform buffers */\r\n    public supportUniformBuffers = false;\r\n    /**\r\n     * Gets the list of emitted attributes\r\n     */\r\n    public attributes = new Array<string>();\r\n    /**\r\n     * Gets the list of emitted uniforms\r\n     */\r\n    public uniforms = new Array<string>();\r\n    /**\r\n     * Gets the list of emitted constants\r\n     */\r\n    public constants = new Array<string>();\r\n    /**\r\n     * Gets the list of emitted samplers\r\n     */\r\n    public samplers = new Array<string>();\r\n    /**\r\n     * Gets the list of emitted functions\r\n     */\r\n    public functions: { [key: string]: string } = {};\r\n    /**\r\n     * Gets the list of emitted extensions\r\n     */\r\n    public extensions: { [key: string]: string } = {};\r\n    /**\r\n     * Gets the list of emitted prePass outputs - if using the prepass\r\n     */\r\n    public prePassOutput: { [key: string]: string } = {};\r\n\r\n    /**\r\n     * Gets the target of the compilation state\r\n     */\r\n    public target: NodeMaterialBlockTargets;\r\n    /**\r\n     * Gets the list of emitted counters\r\n     */\r\n    public counters: { [key: string]: number } = {};\r\n\r\n    /**\r\n     * Shared data between multiple NodeMaterialBuildState instances\r\n     */\r\n    public sharedData: NodeMaterialBuildStateSharedData;\r\n\r\n    /** @internal */\r\n    public _vertexState: NodeMaterialBuildState;\r\n\r\n    /** @internal */\r\n    public _attributeDeclaration = \"\";\r\n    /** @internal */\r\n    public _uniformDeclaration = \"\";\r\n    /** @internal */\r\n    public _constantDeclaration = \"\";\r\n    /** @internal */\r\n    public _samplerDeclaration = \"\";\r\n    /** @internal */\r\n    public _varyingTransfer = \"\";\r\n    /** @internal */\r\n    public _injectAtEnd = \"\";\r\n\r\n    private _repeatableContentAnchorIndex = 0;\r\n    /** @internal */\r\n    public _builtCompilationString = \"\";\r\n\r\n    /**\r\n     * Gets the emitted compilation strings\r\n     */\r\n    public compilationString = \"\";\r\n\r\n    /**\r\n     * Finalize the compilation strings\r\n     * @param state defines the current compilation state\r\n     */\r\n    public finalize(state: NodeMaterialBuildState) {\r\n        const emitComments = state.sharedData.emitComments;\r\n        const isFragmentMode = this.target === NodeMaterialBlockTargets.Fragment;\r\n\r\n        this.compilationString = `\\n${emitComments ? \"//Entry point\\n\" : \"\"}void main(void) {\\n${this.compilationString}`;\r\n\r\n        if (this._constantDeclaration) {\r\n            this.compilationString = `\\n${emitComments ? \"//Constants\\n\" : \"\"}${this._constantDeclaration}\\n${this.compilationString}`;\r\n        }\r\n\r\n        let functionCode = \"\";\r\n        for (const functionName in this.functions) {\r\n            functionCode += this.functions[functionName] + `\\n`;\r\n        }\r\n        this.compilationString = `\\n${functionCode}\\n${this.compilationString}`;\r\n\r\n        if (!isFragmentMode && this._varyingTransfer) {\r\n            this.compilationString = `${this.compilationString}\\n${this._varyingTransfer}`;\r\n        }\r\n\r\n        if (this._injectAtEnd) {\r\n            this.compilationString = `${this.compilationString}\\n${this._injectAtEnd}`;\r\n        }\r\n\r\n        this.compilationString = `${this.compilationString}\\n}`;\r\n\r\n        if (this.sharedData.varyingDeclaration) {\r\n            this.compilationString = `\\n${emitComments ? \"//Varyings\\n\" : \"\"}${this.sharedData.varyingDeclaration}\\n${this.compilationString}`;\r\n        }\r\n\r\n        if (this._samplerDeclaration) {\r\n            this.compilationString = `\\n${emitComments ? \"//Samplers\\n\" : \"\"}${this._samplerDeclaration}\\n${this.compilationString}`;\r\n        }\r\n\r\n        if (this._uniformDeclaration) {\r\n            this.compilationString = `\\n${emitComments ? \"//Uniforms\\n\" : \"\"}${this._uniformDeclaration}\\n${this.compilationString}`;\r\n        }\r\n\r\n        if (this._attributeDeclaration && !isFragmentMode) {\r\n            this.compilationString = `\\n${emitComments ? \"//Attributes\\n\" : \"\"}${this._attributeDeclaration}\\n${this.compilationString}`;\r\n        }\r\n\r\n        this.compilationString = \"precision highp float;\\n\" + this.compilationString;\r\n        this.compilationString = \"#if defined(WEBGL2) || defines(WEBGPU)\\nprecision highp sampler2DArray;\\n#endif\\n\" + this.compilationString;\r\n\r\n        if (isFragmentMode) {\r\n            this.compilationString =\r\n                \"#if defined(PREPASS)\\r\\n#extension GL_EXT_draw_buffers : require\\r\\nlayout(location = 0) out highp vec4 glFragData[SCENE_MRT_COUNT];\\r\\nhighp vec4 gl_FragColor;\\r\\n#endif\\r\\n\" +\r\n                this.compilationString;\r\n        }\r\n\r\n        for (const extensionName in this.extensions) {\r\n            const extension = this.extensions[extensionName];\r\n            this.compilationString = `\\n${extension}\\n${this.compilationString}`;\r\n        }\r\n\r\n        this._builtCompilationString = this.compilationString;\r\n    }\r\n\r\n    /** @internal */\r\n    public get _repeatableContentAnchor(): string {\r\n        return `###___ANCHOR${this._repeatableContentAnchorIndex++}___###`;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _getFreeVariableName(prefix: string): string {\r\n        prefix = prefix.replace(/[^a-zA-Z_]+/g, \"\");\r\n\r\n        if (this.sharedData.variableNames[prefix] === undefined) {\r\n            this.sharedData.variableNames[prefix] = 0;\r\n\r\n            // Check reserved words\r\n            if (prefix === \"output\" || prefix === \"texture\") {\r\n                return prefix + this.sharedData.variableNames[prefix];\r\n            }\r\n\r\n            return prefix;\r\n        } else {\r\n            this.sharedData.variableNames[prefix]++;\r\n        }\r\n\r\n        return prefix + this.sharedData.variableNames[prefix];\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _getFreeDefineName(prefix: string): string {\r\n        if (this.sharedData.defineNames[prefix] === undefined) {\r\n            this.sharedData.defineNames[prefix] = 0;\r\n        } else {\r\n            this.sharedData.defineNames[prefix]++;\r\n        }\r\n\r\n        return prefix + this.sharedData.defineNames[prefix];\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _excludeVariableName(name: string) {\r\n        this.sharedData.variableNames[name] = 0;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emit2DSampler(name: string) {\r\n        if (this.samplers.indexOf(name) < 0) {\r\n            this._samplerDeclaration += `uniform sampler2D ${name};\\n`;\r\n            this.samplers.push(name);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emit2DArraySampler(name: string) {\r\n        if (this.samplers.indexOf(name) < 0) {\r\n            this._samplerDeclaration += `uniform sampler2DArray ${name};\\n`;\r\n            this.samplers.push(name);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _getGLType(type: NodeMaterialBlockConnectionPointTypes): string {\r\n        switch (type) {\r\n            case NodeMaterialBlockConnectionPointTypes.Float:\r\n                return \"float\";\r\n            case NodeMaterialBlockConnectionPointTypes.Int:\r\n                return \"int\";\r\n            case NodeMaterialBlockConnectionPointTypes.Vector2:\r\n                return \"vec2\";\r\n            case NodeMaterialBlockConnectionPointTypes.Color3:\r\n            case NodeMaterialBlockConnectionPointTypes.Vector3:\r\n                return \"vec3\";\r\n            case NodeMaterialBlockConnectionPointTypes.Color4:\r\n            case NodeMaterialBlockConnectionPointTypes.Vector4:\r\n                return \"vec4\";\r\n            case NodeMaterialBlockConnectionPointTypes.Matrix:\r\n                return \"mat4\";\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitExtension(name: string, extension: string, define: string = \"\") {\r\n        if (this.extensions[name]) {\r\n            return;\r\n        }\r\n\r\n        if (define) {\r\n            extension = `#if ${define}\\n${extension}\\n#endif`;\r\n        }\r\n        this.extensions[name] = extension;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitFunction(name: string, code: string, comments: string) {\r\n        if (this.functions[name]) {\r\n            return;\r\n        }\r\n\r\n        if (this.sharedData.emitComments) {\r\n            code = comments + `\\n` + code;\r\n        }\r\n\r\n        this.functions[name] = code;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitCodeFromInclude(\r\n        includeName: string,\r\n        comments: string,\r\n        options?: {\r\n            replaceStrings?: { search: RegExp; replace: string }[];\r\n            repeatKey?: string;\r\n            substitutionVars?: string;\r\n        }\r\n    ) {\r\n        if (options && options.repeatKey) {\r\n            return `#include<${includeName}>${options.substitutionVars ? \"(\" + options.substitutionVars + \")\" : \"\"}[0..${options.repeatKey}]\\n`;\r\n        }\r\n\r\n        let code = Effect.IncludesShadersStore[includeName] + \"\\n\";\r\n\r\n        if (this.sharedData.emitComments) {\r\n            code = comments + `\\n` + code;\r\n        }\r\n\r\n        if (!options) {\r\n            return code;\r\n        }\r\n\r\n        if (options.replaceStrings) {\r\n            for (let index = 0; index < options.replaceStrings.length; index++) {\r\n                const replaceString = options.replaceStrings[index];\r\n                code = code.replace(replaceString.search, replaceString.replace);\r\n            }\r\n        }\r\n\r\n        return code;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitFunctionFromInclude(\r\n        includeName: string,\r\n        comments: string,\r\n        options?: {\r\n            repeatKey?: string;\r\n            substitutionVars?: string;\r\n            removeAttributes?: boolean;\r\n            removeUniforms?: boolean;\r\n            removeVaryings?: boolean;\r\n            removeIfDef?: boolean;\r\n            replaceStrings?: { search: RegExp; replace: string }[];\r\n        },\r\n        storeKey: string = \"\"\r\n    ) {\r\n        const key = includeName + storeKey;\r\n        if (this.functions[key]) {\r\n            return;\r\n        }\r\n\r\n        if (!options || (!options.removeAttributes && !options.removeUniforms && !options.removeVaryings && !options.removeIfDef && !options.replaceStrings)) {\r\n            if (options && options.repeatKey) {\r\n                this.functions[key] = `#include<${includeName}>${options.substitutionVars ? \"(\" + options.substitutionVars + \")\" : \"\"}[0..${options.repeatKey}]\\n`;\r\n            } else {\r\n                this.functions[key] = `#include<${includeName}>${options?.substitutionVars ? \"(\" + options?.substitutionVars + \")\" : \"\"}\\n`;\r\n            }\r\n\r\n            if (this.sharedData.emitComments) {\r\n                this.functions[key] = comments + `\\n` + this.functions[key];\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        this.functions[key] = Effect.IncludesShadersStore[includeName];\r\n\r\n        if (this.sharedData.emitComments) {\r\n            this.functions[key] = comments + `\\n` + this.functions[key];\r\n        }\r\n\r\n        if (options.removeIfDef) {\r\n            this.functions[key] = this.functions[key].replace(/^\\s*?#ifdef.+$/gm, \"\");\r\n            this.functions[key] = this.functions[key].replace(/^\\s*?#endif.*$/gm, \"\");\r\n            this.functions[key] = this.functions[key].replace(/^\\s*?#else.*$/gm, \"\");\r\n            this.functions[key] = this.functions[key].replace(/^\\s*?#elif.*$/gm, \"\");\r\n        }\r\n\r\n        if (options.removeAttributes) {\r\n            this.functions[key] = this.functions[key].replace(/\\s*?attribute .+?;/g, \"\\n\");\r\n        }\r\n\r\n        if (options.removeUniforms) {\r\n            this.functions[key] = this.functions[key].replace(/\\s*?uniform .*?;/g, \"\\n\");\r\n        }\r\n\r\n        if (options.removeVaryings) {\r\n            this.functions[key] = this.functions[key].replace(/\\s*?(varying|in) .+?;/g, \"\\n\");\r\n        }\r\n\r\n        if (options.replaceStrings) {\r\n            for (let index = 0; index < options.replaceStrings.length; index++) {\r\n                const replaceString = options.replaceStrings[index];\r\n                this.functions[key] = this.functions[key].replace(replaceString.search, replaceString.replace);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _registerTempVariable(name: string) {\r\n        if (this.sharedData.temps.indexOf(name) !== -1) {\r\n            return false;\r\n        }\r\n\r\n        this.sharedData.temps.push(name);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitVaryingFromString(name: string, type: string, define: string = \"\", notDefine = false) {\r\n        if (this.sharedData.varyings.indexOf(name) !== -1) {\r\n            return false;\r\n        }\r\n\r\n        this.sharedData.varyings.push(name);\r\n\r\n        if (define) {\r\n            if (define.startsWith(\"defined(\")) {\r\n                this.sharedData.varyingDeclaration += `#if ${define}\\n`;\r\n            } else {\r\n                this.sharedData.varyingDeclaration += `${notDefine ? \"#ifndef\" : \"#ifdef\"} ${define}\\n`;\r\n            }\r\n        }\r\n        this.sharedData.varyingDeclaration += `varying ${type} ${name};\\n`;\r\n        if (define) {\r\n            this.sharedData.varyingDeclaration += `#endif\\n`;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitUniformFromString(name: string, type: string, define: string = \"\", notDefine = false) {\r\n        if (this.uniforms.indexOf(name) !== -1) {\r\n            return;\r\n        }\r\n\r\n        this.uniforms.push(name);\r\n\r\n        if (define) {\r\n            if (define.startsWith(\"defined(\")) {\r\n                this._uniformDeclaration += `#if ${define}\\n`;\r\n            } else {\r\n                this._uniformDeclaration += `${notDefine ? \"#ifndef\" : \"#ifdef\"} ${define}\\n`;\r\n            }\r\n        }\r\n        this._uniformDeclaration += `uniform ${type} ${name};\\n`;\r\n        if (define) {\r\n            this._uniformDeclaration += `#endif\\n`;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _emitFloat(value: number) {\r\n        if (value.toString() === value.toFixed(0)) {\r\n            return `${value}.0`;\r\n        }\r\n\r\n        return value.toString();\r\n    }\r\n}\r\n"],"mappings":";AAAA,SAASA,qCAAqC,QAAQ,kDAAgD;AACtG,SAASC,wBAAwB,QAAQ,qCAAmC;AAE5E,SAASC,MAAM,QAAQ,cAAY;AAEnC;;;AAGA,OAAM,MAAOC,sBAAsB;EAAnCC,YAAA;IACI;IACO,KAAAC,qBAAqB,GAAG,KAAK;IACpC;;;IAGO,KAAAC,UAAU,GAAG,IAAIC,KAAK,EAAU;IACvC;;;IAGO,KAAAC,QAAQ,GAAG,IAAID,KAAK,EAAU;IACrC;;;IAGO,KAAAE,SAAS,GAAG,IAAIF,KAAK,EAAU;IACtC;;;IAGO,KAAAG,QAAQ,GAAG,IAAIH,KAAK,EAAU;IACrC;;;IAGO,KAAAI,SAAS,GAA8B,EAAE;IAChD;;;IAGO,KAAAC,UAAU,GAA8B,EAAE;IACjD;;;IAGO,KAAAC,aAAa,GAA8B,EAAE;IAMpD;;;IAGO,KAAAC,QAAQ,GAA8B,EAAE;IAU/C;IACO,KAAAC,qBAAqB,GAAG,EAAE;IACjC;IACO,KAAAC,mBAAmB,GAAG,EAAE;IAC/B;IACO,KAAAC,oBAAoB,GAAG,EAAE;IAChC;IACO,KAAAC,mBAAmB,GAAG,EAAE;IAC/B;IACO,KAAAC,gBAAgB,GAAG,EAAE;IAC5B;IACO,KAAAC,YAAY,GAAG,EAAE;IAEhB,KAAAC,6BAA6B,GAAG,CAAC;IACzC;IACO,KAAAC,uBAAuB,GAAG,EAAE;IAEnC;;;IAGO,KAAAC,iBAAiB,GAAG,EAAE;EAwWjC;EAtWI;;;;EAIOC,QAAQA,CAACC,KAA6B;IACzC,MAAMC,YAAY,GAAGD,KAAK,CAACE,UAAU,CAACD,YAAY;IAClD,MAAME,cAAc,GAAG,IAAI,CAACC,MAAM,KAAK5B,wBAAwB,CAAC6B,QAAQ;IAExE,IAAI,CAACP,iBAAiB,GAAG,KAAKG,YAAY,GAAG,iBAAiB,GAAG,EAAE,sBAAsB,IAAI,CAACH,iBAAiB,EAAE;IAEjH,IAAI,IAAI,CAACN,oBAAoB,EAAE;MAC3B,IAAI,CAACM,iBAAiB,GAAG,KAAKG,YAAY,GAAG,eAAe,GAAG,EAAE,GAAG,IAAI,CAACT,oBAAoB,KAAK,IAAI,CAACM,iBAAiB,EAAE;;IAG9H,IAAIQ,YAAY,GAAG,EAAE;IACrB,KAAK,MAAMC,YAAY,IAAI,IAAI,CAACrB,SAAS,EAAE;MACvCoB,YAAY,IAAI,IAAI,CAACpB,SAAS,CAACqB,YAAY,CAAC,GAAG,IAAI;;IAEvD,IAAI,CAACT,iBAAiB,GAAG,KAAKQ,YAAY,KAAK,IAAI,CAACR,iBAAiB,EAAE;IAEvE,IAAI,CAACK,cAAc,IAAI,IAAI,CAACT,gBAAgB,EAAE;MAC1C,IAAI,CAACI,iBAAiB,GAAG,GAAG,IAAI,CAACA,iBAAiB,KAAK,IAAI,CAACJ,gBAAgB,EAAE;;IAGlF,IAAI,IAAI,CAACC,YAAY,EAAE;MACnB,IAAI,CAACG,iBAAiB,GAAG,GAAG,IAAI,CAACA,iBAAiB,KAAK,IAAI,CAACH,YAAY,EAAE;;IAG9E,IAAI,CAACG,iBAAiB,GAAG,GAAG,IAAI,CAACA,iBAAiB,KAAK;IAEvD,IAAI,IAAI,CAACI,UAAU,CAACM,kBAAkB,EAAE;MACpC,IAAI,CAACV,iBAAiB,GAAG,KAAKG,YAAY,GAAG,cAAc,GAAG,EAAE,GAAG,IAAI,CAACC,UAAU,CAACM,kBAAkB,KAAK,IAAI,CAACV,iBAAiB,EAAE;;IAGtI,IAAI,IAAI,CAACL,mBAAmB,EAAE;MAC1B,IAAI,CAACK,iBAAiB,GAAG,KAAKG,YAAY,GAAG,cAAc,GAAG,EAAE,GAAG,IAAI,CAACR,mBAAmB,KAAK,IAAI,CAACK,iBAAiB,EAAE;;IAG5H,IAAI,IAAI,CAACP,mBAAmB,EAAE;MAC1B,IAAI,CAACO,iBAAiB,GAAG,KAAKG,YAAY,GAAG,cAAc,GAAG,EAAE,GAAG,IAAI,CAACV,mBAAmB,KAAK,IAAI,CAACO,iBAAiB,EAAE;;IAG5H,IAAI,IAAI,CAACR,qBAAqB,IAAI,CAACa,cAAc,EAAE;MAC/C,IAAI,CAACL,iBAAiB,GAAG,KAAKG,YAAY,GAAG,gBAAgB,GAAG,EAAE,GAAG,IAAI,CAACX,qBAAqB,KAAK,IAAI,CAACQ,iBAAiB,EAAE;;IAGhI,IAAI,CAACA,iBAAiB,GAAG,0BAA0B,GAAG,IAAI,CAACA,iBAAiB;IAC5E,IAAI,CAACA,iBAAiB,GAAG,mFAAmF,GAAG,IAAI,CAACA,iBAAiB;IAErI,IAAIK,cAAc,EAAE;MAChB,IAAI,CAACL,iBAAiB,GAClB,gLAAgL,GAChL,IAAI,CAACA,iBAAiB;;IAG9B,KAAK,MAAMW,aAAa,IAAI,IAAI,CAACtB,UAAU,EAAE;MACzC,MAAMuB,SAAS,GAAG,IAAI,CAACvB,UAAU,CAACsB,aAAa,CAAC;MAChD,IAAI,CAACX,iBAAiB,GAAG,KAAKY,SAAS,KAAK,IAAI,CAACZ,iBAAiB,EAAE;;IAGxE,IAAI,CAACD,uBAAuB,GAAG,IAAI,CAACC,iBAAiB;EACzD;EAEA;EACA,IAAWa,wBAAwBA,CAAA;IAC/B,OAAO,eAAe,IAAI,CAACf,6BAA6B,EAAE,QAAQ;EACtE;EAEA;;;EAGOgB,oBAAoBA,CAACC,MAAc;IACtCA,MAAM,GAAGA,MAAM,CAACC,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC;IAE3C,IAAI,IAAI,CAACZ,UAAU,CAACa,aAAa,CAACF,MAAM,CAAC,KAAKG,SAAS,EAAE;MACrD,IAAI,CAACd,UAAU,CAACa,aAAa,CAACF,MAAM,CAAC,GAAG,CAAC;MAEzC;MACA,IAAIA,MAAM,KAAK,QAAQ,IAAIA,MAAM,KAAK,SAAS,EAAE;QAC7C,OAAOA,MAAM,GAAG,IAAI,CAACX,UAAU,CAACa,aAAa,CAACF,MAAM,CAAC;;MAGzD,OAAOA,MAAM;KAChB,MAAM;MACH,IAAI,CAACX,UAAU,CAACa,aAAa,CAACF,MAAM,CAAC,EAAE;;IAG3C,OAAOA,MAAM,GAAG,IAAI,CAACX,UAAU,CAACa,aAAa,CAACF,MAAM,CAAC;EACzD;EAEA;;;EAGOI,kBAAkBA,CAACJ,MAAc;IACpC,IAAI,IAAI,CAACX,UAAU,CAACgB,WAAW,CAACL,MAAM,CAAC,KAAKG,SAAS,EAAE;MACnD,IAAI,CAACd,UAAU,CAACgB,WAAW,CAACL,MAAM,CAAC,GAAG,CAAC;KAC1C,MAAM;MACH,IAAI,CAACX,UAAU,CAACgB,WAAW,CAACL,MAAM,CAAC,EAAE;;IAGzC,OAAOA,MAAM,GAAG,IAAI,CAACX,UAAU,CAACgB,WAAW,CAACL,MAAM,CAAC;EACvD;EAEA;;;EAGOM,oBAAoBA,CAACC,IAAY;IACpC,IAAI,CAAClB,UAAU,CAACa,aAAa,CAACK,IAAI,CAAC,GAAG,CAAC;EAC3C;EAEA;;;EAGOC,cAAcA,CAACD,IAAY;IAC9B,IAAI,IAAI,CAACnC,QAAQ,CAACqC,OAAO,CAACF,IAAI,CAAC,GAAG,CAAC,EAAE;MACjC,IAAI,CAAC3B,mBAAmB,IAAI,qBAAqB2B,IAAI,KAAK;MAC1D,IAAI,CAACnC,QAAQ,CAACsC,IAAI,CAACH,IAAI,CAAC;;EAEhC;EAEA;;;EAGOI,mBAAmBA,CAACJ,IAAY;IACnC,IAAI,IAAI,CAACnC,QAAQ,CAACqC,OAAO,CAACF,IAAI,CAAC,GAAG,CAAC,EAAE;MACjC,IAAI,CAAC3B,mBAAmB,IAAI,0BAA0B2B,IAAI,KAAK;MAC/D,IAAI,CAACnC,QAAQ,CAACsC,IAAI,CAACH,IAAI,CAAC;;EAEhC;EAEA;;;EAGOK,UAAUA,CAACC,IAA2C;IACzD,QAAQA,IAAI;MACR,KAAKnD,qCAAqC,CAACoD,KAAK;QAC5C,OAAO,OAAO;MAClB,KAAKpD,qCAAqC,CAACqD,GAAG;QAC1C,OAAO,KAAK;MAChB,KAAKrD,qCAAqC,CAACsD,OAAO;QAC9C,OAAO,MAAM;MACjB,KAAKtD,qCAAqC,CAACuD,MAAM;MACjD,KAAKvD,qCAAqC,CAACwD,OAAO;QAC9C,OAAO,MAAM;MACjB,KAAKxD,qCAAqC,CAACyD,MAAM;MACjD,KAAKzD,qCAAqC,CAAC0D,OAAO;QAC9C,OAAO,MAAM;MACjB,KAAK1D,qCAAqC,CAAC2D,MAAM;QAC7C,OAAO,MAAM;;IAGrB,OAAO,EAAE;EACb;EAEA;;;EAGOC,cAAcA,CAACf,IAAY,EAAEV,SAAiB,EAAE0B,MAAA,GAAiB,EAAE;IACtE,IAAI,IAAI,CAACjD,UAAU,CAACiC,IAAI,CAAC,EAAE;MACvB;;IAGJ,IAAIgB,MAAM,EAAE;MACR1B,SAAS,GAAG,OAAO0B,MAAM,KAAK1B,SAAS,UAAU;;IAErD,IAAI,CAACvB,UAAU,CAACiC,IAAI,CAAC,GAAGV,SAAS;EACrC;EAEA;;;EAGO2B,aAAaA,CAACjB,IAAY,EAAEkB,IAAY,EAAEC,QAAgB;IAC7D,IAAI,IAAI,CAACrD,SAAS,CAACkC,IAAI,CAAC,EAAE;MACtB;;IAGJ,IAAI,IAAI,CAAClB,UAAU,CAACD,YAAY,EAAE;MAC9BqC,IAAI,GAAGC,QAAQ,GAAG,IAAI,GAAGD,IAAI;;IAGjC,IAAI,CAACpD,SAAS,CAACkC,IAAI,CAAC,GAAGkB,IAAI;EAC/B;EAEA;;;EAGOE,oBAAoBA,CACvBC,WAAmB,EACnBF,QAAgB,EAChBG,OAIC;IAED,IAAIA,OAAO,IAAIA,OAAO,CAACC,SAAS,EAAE;MAC9B,OAAO,YAAYF,WAAW,IAAIC,OAAO,CAACE,gBAAgB,GAAG,GAAG,GAAGF,OAAO,CAACE,gBAAgB,GAAG,GAAG,GAAG,EAAE,OAAOF,OAAO,CAACC,SAAS,KAAK;;IAGvI,IAAIL,IAAI,GAAG7D,MAAM,CAACoE,oBAAoB,CAACJ,WAAW,CAAC,GAAG,IAAI;IAE1D,IAAI,IAAI,CAACvC,UAAU,CAACD,YAAY,EAAE;MAC9BqC,IAAI,GAAGC,QAAQ,GAAG,IAAI,GAAGD,IAAI;;IAGjC,IAAI,CAACI,OAAO,EAAE;MACV,OAAOJ,IAAI;;IAGf,IAAII,OAAO,CAACI,cAAc,EAAE;MACxB,KAAK,IAAIC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGL,OAAO,CAACI,cAAc,CAACE,MAAM,EAAED,KAAK,EAAE,EAAE;QAChE,MAAME,aAAa,GAAGP,OAAO,CAACI,cAAc,CAACC,KAAK,CAAC;QACnDT,IAAI,GAAGA,IAAI,CAACxB,OAAO,CAACmC,aAAa,CAACC,MAAM,EAAED,aAAa,CAACnC,OAAO,CAAC;;;IAIxE,OAAOwB,IAAI;EACf;EAEA;;;EAGOa,wBAAwBA,CAC3BV,WAAmB,EACnBF,QAAgB,EAChBG,OAQC,EACDU,QAAA,GAAmB,EAAE;IAErB,MAAMC,GAAG,GAAGZ,WAAW,GAAGW,QAAQ;IAClC,IAAI,IAAI,CAAClE,SAAS,CAACmE,GAAG,CAAC,EAAE;MACrB;;IAGJ,IAAI,CAACX,OAAO,IAAK,CAACA,OAAO,CAACY,gBAAgB,IAAI,CAACZ,OAAO,CAACa,cAAc,IAAI,CAACb,OAAO,CAACc,cAAc,IAAI,CAACd,OAAO,CAACe,WAAW,IAAI,CAACf,OAAO,CAACI,cAAe,EAAE;MAClJ,IAAIJ,OAAO,IAAIA,OAAO,CAACC,SAAS,EAAE;QAC9B,IAAI,CAACzD,SAAS,CAACmE,GAAG,CAAC,GAAG,YAAYZ,WAAW,IAAIC,OAAO,CAACE,gBAAgB,GAAG,GAAG,GAAGF,OAAO,CAACE,gBAAgB,GAAG,GAAG,GAAG,EAAE,OAAOF,OAAO,CAACC,SAAS,KAAK;OACrJ,MAAM;QACH,IAAI,CAACzD,SAAS,CAACmE,GAAG,CAAC,GAAG,YAAYZ,WAAW,IAAI,CAAAC,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEE,gBAAgB,IAAG,GAAG,IAAGF,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEE,gBAAgB,IAAG,GAAG,GAAG,EAAE,IAAI;;MAG/H,IAAI,IAAI,CAAC1C,UAAU,CAACD,YAAY,EAAE;QAC9B,IAAI,CAACf,SAAS,CAACmE,GAAG,CAAC,GAAGd,QAAQ,GAAG,IAAI,GAAG,IAAI,CAACrD,SAAS,CAACmE,GAAG,CAAC;;MAG/D;;IAGJ,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,GAAG5E,MAAM,CAACoE,oBAAoB,CAACJ,WAAW,CAAC;IAE9D,IAAI,IAAI,CAACvC,UAAU,CAACD,YAAY,EAAE;MAC9B,IAAI,CAACf,SAAS,CAACmE,GAAG,CAAC,GAAGd,QAAQ,GAAG,IAAI,GAAG,IAAI,CAACrD,SAAS,CAACmE,GAAG,CAAC;;IAG/D,IAAIX,OAAO,CAACe,WAAW,EAAE;MACrB,IAAI,CAACvE,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC;MACzE,IAAI,CAAC5B,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC;MACzE,IAAI,CAAC5B,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC;MACxE,IAAI,CAAC5B,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC;;IAG5E,IAAI4B,OAAO,CAACY,gBAAgB,EAAE;MAC1B,IAAI,CAACpE,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,qBAAqB,EAAE,IAAI,CAAC;;IAGlF,IAAI4B,OAAO,CAACa,cAAc,EAAE;MACxB,IAAI,CAACrE,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,mBAAmB,EAAE,IAAI,CAAC;;IAGhF,IAAI4B,OAAO,CAACc,cAAc,EAAE;MACxB,IAAI,CAACtE,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAAC;;IAGrF,IAAI4B,OAAO,CAACI,cAAc,EAAE;MACxB,KAAK,IAAIC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGL,OAAO,CAACI,cAAc,CAACE,MAAM,EAAED,KAAK,EAAE,EAAE;QAChE,MAAME,aAAa,GAAGP,OAAO,CAACI,cAAc,CAACC,KAAK,CAAC;QACnD,IAAI,CAAC7D,SAAS,CAACmE,GAAG,CAAC,GAAG,IAAI,CAACnE,SAAS,CAACmE,GAAG,CAAC,CAACvC,OAAO,CAACmC,aAAa,CAACC,MAAM,EAAED,aAAa,CAACnC,OAAO,CAAC;;;EAG1G;EAEA;;;EAGO4C,qBAAqBA,CAACtC,IAAY;IACrC,IAAI,IAAI,CAAClB,UAAU,CAACyD,KAAK,CAACrC,OAAO,CAACF,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;MAC5C,OAAO,KAAK;;IAGhB,IAAI,CAAClB,UAAU,CAACyD,KAAK,CAACpC,IAAI,CAACH,IAAI,CAAC;IAChC,OAAO,IAAI;EACf;EAEA;;;EAGOwC,sBAAsBA,CAACxC,IAAY,EAAEM,IAAY,EAAEU,MAAA,GAAiB,EAAE,EAAEyB,SAAS,GAAG,KAAK;IAC5F,IAAI,IAAI,CAAC3D,UAAU,CAAC4D,QAAQ,CAACxC,OAAO,CAACF,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;MAC/C,OAAO,KAAK;;IAGhB,IAAI,CAAClB,UAAU,CAAC4D,QAAQ,CAACvC,IAAI,CAACH,IAAI,CAAC;IAEnC,IAAIgB,MAAM,EAAE;MACR,IAAIA,MAAM,CAAC2B,UAAU,CAAC,UAAU,CAAC,EAAE;QAC/B,IAAI,CAAC7D,UAAU,CAACM,kBAAkB,IAAI,OAAO4B,MAAM,IAAI;OAC1D,MAAM;QACH,IAAI,CAAClC,UAAU,CAACM,kBAAkB,IAAI,GAAGqD,SAAS,GAAG,SAAS,GAAG,QAAQ,IAAIzB,MAAM,IAAI;;;IAG/F,IAAI,CAAClC,UAAU,CAACM,kBAAkB,IAAI,WAAWkB,IAAI,IAAIN,IAAI,KAAK;IAClE,IAAIgB,MAAM,EAAE;MACR,IAAI,CAAClC,UAAU,CAACM,kBAAkB,IAAI,UAAU;;IAGpD,OAAO,IAAI;EACf;EAEA;;;EAGOwD,sBAAsBA,CAAC5C,IAAY,EAAEM,IAAY,EAAEU,MAAA,GAAiB,EAAE,EAAEyB,SAAS,GAAG,KAAK;IAC5F,IAAI,IAAI,CAAC9E,QAAQ,CAACuC,OAAO,CAACF,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;MACpC;;IAGJ,IAAI,CAACrC,QAAQ,CAACwC,IAAI,CAACH,IAAI,CAAC;IAExB,IAAIgB,MAAM,EAAE;MACR,IAAIA,MAAM,CAAC2B,UAAU,CAAC,UAAU,CAAC,EAAE;QAC/B,IAAI,CAACxE,mBAAmB,IAAI,OAAO6C,MAAM,IAAI;OAChD,MAAM;QACH,IAAI,CAAC7C,mBAAmB,IAAI,GAAGsE,SAAS,GAAG,SAAS,GAAG,QAAQ,IAAIzB,MAAM,IAAI;;;IAGrF,IAAI,CAAC7C,mBAAmB,IAAI,WAAWmC,IAAI,IAAIN,IAAI,KAAK;IACxD,IAAIgB,MAAM,EAAE;MACR,IAAI,CAAC7C,mBAAmB,IAAI,UAAU;;EAE9C;EAEA;;;EAGO0E,UAAUA,CAACC,KAAa;IAC3B,IAAIA,KAAK,CAACC,QAAQ,EAAE,KAAKD,KAAK,CAACE,OAAO,CAAC,CAAC,CAAC,EAAE;MACvC,OAAO,GAAGF,KAAK,IAAI;;IAGvB,OAAOA,KAAK,CAACC,QAAQ,EAAE;EAC3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}